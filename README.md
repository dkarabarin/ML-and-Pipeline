# Прогнозирование покупательской активности для интернет-магазина «В один клик»

## Описание проекта

Интернет-магазин «В один клик» продаёт различные товары: для детей, для дома, мелкую бытовую технику, косметику и продукты. Анализ отчётов показал снижение активности покупателей. Поскольку привлечение новых клиентов становится менее эффективным, компания решила сосредоточиться на удержании существующих клиентов с помощью персонализированных предложений.

**Цель проекта:** Разработать рекомендации по удержанию клиентов на основе анализа данных и машинного обучения.

**Задачи:**
1. Прогнозирование снижения покупательской активности
2. Сегментация клиентов для персонализированных предложений
3. Выявление ключевых факторов, влияющих на активность клиентов

## Данные

Проект использует 4 источника данных:

1. **market_file.csv** - основная информация о клиентах (1300 записей)
   - Демографические данные
   - Покупательское поведение
   - Использование сервиса

2. **market_money.csv** - выручка по клиентам за 3 месяца (3900 записей)
   - Выручка за препредыдущий, предыдущий и текущий месяцы

3. **market_time.csv** - время на сайте по клиентам (2600 записей)
   - Время на сайте за предыдущий и текущий месяцы

4. **money.csv** - прибыль по клиентам (1300 записей)

## Методология

### 1. Предобработка данных
- Проверка на пропуски и дубликаты
- Исправление опечаток в категориальных признаках
- Приведение всех текстовых данных к нижнему регистру
- Удаление клиентов с нулевой выручкой за все периоды

### 2. Исследовательский анализ данных
- Анализ распределения числовых и категориальных признаков
- Исследование корреляций между признаками (Phik-корреляция)
- Выявление аномалий и выбросов

### 3. Объединение данных
- Создание единой таблицы с агрегированными показателями
- Добавление признаков:
  - Выручка по месяцам (отдельные столбцы)
  - Время на сайте по месяцам (отдельные столбцы)
  - Средняя выручка за 3 месяца

### 4. Моделирование
- Сравнение 4 моделей машинного обучения:
  - Logistic Regression
  - Decision Tree
  - K-Nearest Neighbors (KNN)
  - Support Vector Classifier (SVC)
- Использование пайплайнов для предобработки
- Подбор гиперпараметров с помощью RandomizedSearchCV
- Оценка качества моделей по ROC-AUC

### 5. Анализ важности признаков
- Использование Permutation Importance для KNN
- SHAP-анализ для интерпретации модели

### 6. Сегментация клиентов
- Кластеризация методом K-Means
- Сегментация по двум ключевым параметрам:
  - Вероятность снижения активности
  - Средняя выручка за 3 месяца

## Результаты

### Лучшая модель: K-Nearest Neighbors
- **ROC-AUC на кросс-валидации:** 0.9213 ± 0.0188
- **ROC-AUC на тестовой выборке:** 0.9196
- **Параметры:**
  - Количество соседей: 12
  - Веса: distance
  - Препроцессинг: RobustScaler для числовых признаков, OneHotEncoder для категориальных

### Важность признаков (Топ-5)
1. **Акционные покупки** (важность: 0.069)
2. **Страниц за визит** (важность: 0.055)
3. **Минут на сайте (текущий месяц)** (важность: 0.042)
4. **Минут на сайте (предыдущий месяц)** (важность: 0.027)
5. **Неоплаченные продукты за квартал** (важность: 0.017)

### Сегменты клиентов
**4 сегмента были выявлены:**
- **Сегмент 0** (274 клиента): Высокая активность, высокая выручка
- **Сегмент 1** (400 клиентов): Низкая активность, средняя выручка
- **Сегмент 2** (211 клиентов): Высокая активность, средняя выручка
- **Сегмент 3** (412 клиентов): Низкая активность, высокая выручка

## Ключевые выводы

### Факторы, повышающие риск снижения активности:
1. **Высокий процент акционных покупок** - клиенты, покупающие преимущественно по акциям, чаще снижают активность
2. **Мало времени на сайте** - клиенты, проводящие меньше времени, чаще теряют интерес
3. **Малое количество просмотренных страниц** - поверхностное знакомство с ассортиментом

### Факторы, снижающие риск:
1. **Разнообразие просматриваемых категорий**
2. **Стабильная активность в течение 6 месяцев**
3. **Регулярное время на сайте**

## Рекомендации для бизнеса

### Для всех клиентов:
1. **Увеличить вовлеченность:**
   - Персонализированные рекомендации
   - Система лояльности с бонусами за активность
   - Регулярные email-рассылки с интересным контентом

### Для Сегмента 0 (высокий риск, высокая выручка):
1. **Персональный подход:**
   - Персональный менеджер для VIP-клиентов
   - Эксклюзивные предложения и ранний доступ к новинкам
   - Специальные условия доставки и обслуживания

### Для Сегмента 3 (низкая активность, высокая выручка):
1. **Реактивация:**
   - Специальные промокоды для возвращения
   - Напоминания о брошенных корзинах
   - Предложения, основанные на истории покупок

### Для Сегмента 1 и 2 (средняя выручка):
1. **Стимулирование активности:**
   - Программы кэшбэка за регулярные покупки
   - Бонусы за привлечение друзей
   - Сезонные акции на популярные категории

### Технические рекомендации:
1. **Улучшение пользовательского опыта:**
   - Ускорение загрузки страниц
   - Улучшение поиска и фильтрации
   - Мобильная оптимизация

2. **Мониторинг:**
   - Регулярный анализ метрик активности
   - Автоматическое выявление "уходящих" клиентов
   - A/B-тестирование новых функций

## Используемые технологии

- **Python 3.9**
- **Pandas, NumPy** - обработка данных
- **Scikit-learn** - машинное обучение
- **Matplotlib, Seaborn** - визуализация
- **Phik** - анализ корреляций
- **SHAP** - интерпретация моделей
- **K-Means** - кластеризация

## Структура проекта
ecommerce_activity_prediction/
├── data/
│ ├── market_file.csv
│ ├── market_money.csv
│ ├── market_time.csv
│ └── money.csv
├── notebooks/
│ └── ecommerce_analysis.ipynb
├── models/
│ └── best_model.pkl
├── reports/
│ └── business_recommendations.pdf
└── README.md

## Установка и запуск

```bash
# Установка зависимостей
pip install pandas numpy scikit-learn matplotlib seaborn phik shap

# Запуск анализа
jupyter notebook ecommerce_analysis.ipynb
